{% extends "base.html" %}
{% block title %}Change Password{% endblock %}
{% block content %}
<h1>Change Password</h1>
<form method="POST" id="pw-form" novalidate>
  {{ form.hidden_tag() }}
  <div>{{ form.current_password.label }} {{ form.current_password(size=32, autocomplete="current-password") }}</div>
  <div>
    {{ form.new_password.label }} {{ form.new_password(size=32, id="new_password", autocomplete="new-password") }}
    <div class="pw-meter" aria-live="polite">
      <div class="pw-bar" id="pw-bar"></div>
      <div class="pw-label" id="pw-label">Enter a strong password.</div>
      <ul class="pw-tips">
        <li><strong>Tip:</strong> Use 12+ characters</li>
        <li><strong>Tip:</strong> Mix upper/lowercase, numbers, symbols</li>
        <li><strong>Tip:</strong> Avoid names, emails, or common words</li>
      </ul>
    </div>
  </div>
  <div>{{ form.confirm_new_password.label }} {{ form.confirm_new_password(size=32, autocomplete="new-password") }}</div>
  {% if current_user.otp_secret %}
    <div>{{ form.token.label }} {{ form.token(size=6, inputmode="numeric", pattern="[0-9]*", autocomplete="one-time-code") }}</div>
  {% endif %}
  <div>{{ form.submit(class="btn", id="submit_btn", disabled=True) }}</div>
</form>
<script>
// (strength meter JS as previously provided)
</script>
{% endblock %}
